// Translation system for Wasla app
const translations = {
    ar: {
        // Navigation
        home: 'الرئيسية',
        chatbot: 'المساعد الذكي',
        search: 'البحث',
        importantStops: 'المحطات المهمة',
        userRoutes: 'طرق المستخدمين',
        credits: 'الرصيد',
        
        // Home page
        navigateEgypt: 'تنقل في مصر بسهولة',
        comprehensiveGuide: 'دليلك الشامل للمواصلات في مصر. مترو، أتوبيسات، ميكروباصات - كلها في منصة ذكية واحدة مدعومة بمعرفة المجتمع.',
        askChatBot: 'اسأل المساعد الذكي',
        searchRoutes: 'ابحث عن الطرق',
        aiChatBot: 'المساعد الذكي',
        aiChatBotDesc: 'اسأل بلغة طبيعية: "أنا في مدينة نصر وأريد الذهاب إلى مدينة 6 أكتوبر"',
        manualSearch: 'البحث اليدوي',
        manualSearchDesc: 'ابحث عن الطرق يدوياً مع عرض الخريطة',
        importantStopsDesc: 'استكشف المحاور الرئيسية مثل رمسيس وعبود والمنيب',
        communityRoutes: 'طرق المجتمع',
        communityRoutesDesc: 'أضف طرق جديدة، صوت، وساعد في تحسين الشبكة',
        transportationNetwork: 'شبكة المواصلات',
        metroLines: 'خطوط المترو',
        busRoutes: 'خطوط الأتوبيس',
        microbusLines: 'خطوط الميكروباص',
        majorStops: 'المحطات الرئيسية',
        
        // ChatBot
        waslaAssistant: 'مساعد وصلة',
        askAnything: 'اسألني أي شيء عن التنقل في مصر!',
        searching: 'جاري البحث...',
        findRoutes: 'ابحث عن الطرق',
        
        // Search
        routePlanner: 'مخطط الرحلات',
        planJourney: 'خطط رحلتك عبر مصر مع توجيهات مفصلة خطوة بخطوة.',
        from: 'من',
        to: 'إلى',
        enterStarting: 'أدخل نقطة البداية',
        enterDestination: 'أدخل الوجهة',
        routeMap: 'خريطة الطريق',
        routeOptions: 'خيارات الطرق',
        
        // Footer
        footerText: 'ربط كل مصر، طريق واحد في كل مرة.',
        
        // Credits
        creditsAndBilling: 'الرصيد والفواتير',
        manageUsage: 'إدارة الاستخدام وشراء الرصيد للوصول غير المحدود لطرق المواصلات.',
        currentBalance: 'الرصيد الحالي',
        credits: 'رصيد',
        eachSearch: 'كل بحث أو استعلام للمساعد الذكي يستخدم رصيد واحد',
        purchaseCredits: 'شراء الرصيد',
        
        // User Routes
        communityRoutesTitle: 'طرق المجتمع',
        helpImprove: 'ساعد في تحسين شبكة المواصلات في مصر من خلال مشاركة الطرق والتصويت على المساهمات.',
        addRoute: 'أضف طريق',
        addNewRoute: 'أضف طريق جديد',
        routeName: 'اسم الطريق',
        cancel: 'إلغاء',
        submitRoute: 'إرسال الطريق',
        
        // Important Stops
        importantTransportationStops: 'المحطات المهمة للمواصلات',
        exploreHubs: 'استكشف محاور المواصلات الرئيسية في مصر مع معلومات مفصلة عن الطرق والاتصالات.',
        
        // Language
        languageText: 'English',
        
        // Authentication
        createAccount: 'إنشاء حساب',
        signIn: 'تسجيل الدخول',
        logout: 'تسجيل الخروج',
        fullName: 'الاسم الكامل',
        email: 'البريد الإلكتروني',
        password: 'كلمة المرور',
        preferredCurrency: 'العملة المفضلة',
        createAccountWithCredits: 'إنشاء حساب + 10 رصيد مجاني',
        welcomeBack: 'مرحباً بعودتك إلى وصلة!',
        joinCommunity: 'انضم إلى مجتمع وصلة واحصل على رصيد مجاني!',
        loginRequired: 'تسجيل الدخول مطلوب',
        loginRequiredDesc: 'يجب إنشاء حساب أو تسجيل الدخول لاستخدام هذه الميزة',
        
        // Country selection
        welcomeToWasla: 'مرحباً بك في وصلة',
        whichCountry: 'أي دولة تريد معرفة طرق المواصلات فيها؟',
        egypt: 'مصر',
        otherCountries: 'دول أخرى',
        changeCountry: 'تغيير الدولة',
    },
    en: {
        // Navigation
        home: 'Home',
        chatbot: 'ChatBot',
        search: 'Search',
        importantStops: 'Important Stops',
        userRoutes: 'User Routes',
        credits: 'Credits',
        
        // Home page
        navigateEgypt: 'Navigate Egypt with Ease',
        comprehensiveGuide: 'Your comprehensive guide to transportation across Egypt. Metro, buses, microbuses - all in one intelligent platform powered by community knowledge.',
        askChatBot: 'Ask the ChatBot',
        searchRoutes: 'Search Routes',
        aiChatBot: 'AI ChatBot',
        aiChatBotDesc: 'Ask in natural language: "I\'m in Nasr City, take me to 6th October"',
        manualSearch: 'Manual Search',
        manualSearchDesc: 'Search routes manually with map visualization',
        importantStopsDesc: 'Explore major hubs like Ramses, Aboud, and El-Monib',
        communityRoutes: 'Community Routes',
        communityRoutesDesc: 'Add new routes, vote, and help improve the network',
        transportationNetwork: 'Transportation Network',
        metroLines: 'Metro Lines',
        busRoutes: 'Bus Routes',
        microbusLines: 'Microbus Lines',
        majorStops: 'Major Stops',
        
        // ChatBot
        waslaAssistant: 'Wasla Assistant',
        askAnything: 'Ask me anything about getting around Egypt!',
        searching: 'Searching...',
        findRoutes: 'Find Routes',
        
        // Search
        routePlanner: 'Route Planner',
        planJourney: 'Plan your journey across Egypt with detailed step-by-step directions.',
        from: 'From',
        to: 'To',
        enterStarting: 'Enter starting location',
        enterDestination: 'Enter destination',
        routeMap: 'Route Map',
        routeOptions: 'Route Options',
        
        // Footer
        footerText: 'Connecting all of Egypt, one route at a time.',
        
        // Credits
        creditsAndBilling: 'Credits & Billing',
        manageUsage: 'Manage your usage and purchase credits for unlimited access to transportation routes.',
        currentBalance: 'Current Balance',
        credits: 'Credits',
        eachSearch: 'Each search or chatbot query uses 1 credit',
        purchaseCredits: 'Purchase Credits',
        
        // User Routes
        communityRoutesTitle: 'Community Routes',
        helpImprove: 'Help improve Egypt\'s transportation network by sharing routes and voting on submissions.',
        addRoute: 'Add Route',
        addNewRoute: 'Add New Route',
        routeName: 'Route Name',
        cancel: 'Cancel',
        submitRoute: 'Submit Route',
        
        // Important Stops
        importantTransportationStops: 'Important Transportation Stops',
        exploreHubs: 'Explore Egypt\'s major transportation hubs with detailed route information and connections.',
        
        // Language
        languageText: 'العربية',
        
        // Authentication
        createAccount: 'Create Account',
        signIn: 'Sign In',
        logout: 'Logout',
        fullName: 'Full Name',
        email: 'Email',
        password: 'Password',
        preferredCurrency: 'Preferred Currency',
        createAccountWithCredits: 'Create Account + 10 Free Credits',
        welcomeBack: 'Welcome back to Wasla!',
        joinCommunity: 'Join Wasla community and get free credits!',
        loginRequired: 'Login Required',
        loginRequiredDesc: 'You need to create an account or sign in to use this feature',
        
        // Country selection
        welcomeToWasla: 'Welcome to Wasla',
        whichCountry: 'Which country do you want to know about transportation methods in?',
        egypt: 'Egypt',
        otherCountries: 'Other Countries',
        changeCountry: 'Change Country',
    }
};

// Current language state
export let currentLanguage = 'ar';

// Translation function
export function t(key) {
    return translations[currentLanguage][key] || key;
}

// Update all translatable elements
export function updateTranslations() {
    // Update document attributes
    document.documentElement.lang = currentLanguage;
    document.documentElement.dir = currentLanguage === 'ar' ? 'rtl' : 'ltr';
    
    // Update title
    document.title = currentLanguage === 'ar' ? 'وصلة - تنقل في مصر بسهولة' : 'Wasla - Navigate Egypt with Ease';
    
    // Update navigation
    const navTexts = document.querySelectorAll('.nav-text');
    const mobileNavTexts = document.querySelectorAll('.mobile-nav-text');
    const navItems = ['home', 'chatbot', 'search', 'importantStops', 'userRoutes', 'credits'];
    
    navTexts.forEach((element, index) => {
        if (navItems[index]) {
            element.textContent = t(navItems[index]);
        }
    });
    
    mobileNavTexts.forEach((element, index) => {
        if (navItems[index]) {
            element.textContent = t(navItems[index]);
        }
    });
    
    // Update language toggle text
    document.querySelectorAll('.language-text').forEach(el => {
        el.textContent = t('languageText');
    });
    document.querySelectorAll('.mobile-language-text').forEach(el => {
        el.textContent = t('languageText');
    });
    
    // Update country button text
    document.querySelectorAll('.country-text').forEach(el => {
        el.textContent = t('egypt');
    });
    document.querySelectorAll('.mobile-country-text').forEach(el => {
        el.textContent = t('egypt');
    });
    
    // Update page content
    updatePageContent();
}

function updatePageContent() {
    // Home page
    const heroTitle = document.querySelector('.hero-title');
    const heroEgypt = document.querySelector('.hero-egypt');
    if (heroTitle && heroEgypt) {
        if (currentLanguage === 'ar') {
            heroTitle.textContent = 'تنقل في ';
            heroEgypt.textContent = 'مصر';
            heroTitle.parentNode.lastChild.textContent = ' بسهولة';
        } else {
            heroTitle.textContent = 'Navigate ';
            heroEgypt.textContent = 'Egypt';
            heroTitle.parentNode.lastChild.textContent = ' with Ease';
        }
    }
    
    // Update all elements with translation classes
    const elementsToUpdate = [
        'hero-subtitle', 'ask-chatbot-text', 'search-routes-text', 'feature-title',
        'feature-desc', 'explore-text', 'network-title', 'stat-label', 'chatbot-title',
        'chatbot-subtitle', 'initial-message', 'chat-hint', 'search-title', 'search-subtitle',
        'from-label', 'to-label', 'find-routes-text', 'map-title', 'map-placeholder',
        'route-options-title', 'stops-title', 'stops-subtitle', 'user-routes-title',
        'user-routes-subtitle', 'add-route-text', 'credits-title', 'credits-subtitle',
        'balance-title', 'credits-text', 'usage-info', 'purchase-title', 'footer-text',
        'modal-title', 'route-name-label', 'from-modal-label', 'to-modal-label',
        'cancel-text', 'submit-text', 'create-account', 'sign-in', 'logout-text',
        'full-name', 'email-label', 'password-label', 'preferred-currency',
        'create-account-with-credits', 'welcome-back', 'join-community',
        'login-required', 'login-required-desc', 'welcome-to-wasla',
        'which-country', 'egypt-text', 'other-countries'
    ];
    
    elementsToUpdate.forEach(className => {
        const elements = document.querySelectorAll(`.${className}`);
        elements.forEach(element => {
            const key = className.replace('-', '').replace('text', '').replace('label', '').replace('title', '').replace('subtitle', '');
            const translationKey = getTranslationKey(className);
            if (translationKey && translations[currentLanguage][translationKey]) {
                element.textContent = translations[currentLanguage][translationKey];
            }
        });
    });
    
    // Update placeholders
    const originInput = document.getElementById('origin-input');
    const destinationInput = document.getElementById('destination-input');
    const chatInput = document.getElementById('chat-input');
    
    if (originInput) {
        originInput.placeholder = t('enterStarting');
    }
    if (destinationInput) {
        destinationInput.placeholder = t('enterDestination');
    }
    if (chatInput) {
        chatInput.placeholder = currentLanguage === 'ar' 
            ? "اسأل عن الطرق... مثل: 'من مصر الجديدة إلى وسط البلد'"
            : "Ask about routes... e.g., 'From Heliopolis to Downtown'";
    }
}

function getTranslationKey(className) {
    const keyMap = {
        'hero-subtitle': 'comprehensiveGuide',
        'ask-chatbot-text': 'askChatBot',
        'search-routes-text': 'searchRoutes',
        'network-title': 'transportationNetwork',
        'chatbot-title': 'waslaAssistant',
        'chatbot-subtitle': 'askAnything',
        'initial-message': 'askAnything',
        'chat-hint': 'chatHint',
        'search-title': 'routePlanner',
        'search-subtitle': 'planJourney',
        'from-label': 'from',
        'to-label': 'to',
        'find-routes-text': 'findRoutes',
        'map-title': 'routeMap',
        'map-placeholder': 'mapPlaceholder',
        'route-options-title': 'routeOptions',
        'stops-title': 'importantTransportationStops',
        'stops-subtitle': 'exploreHubs',
        'user-routes-title': 'communityRoutesTitle',
        'user-routes-subtitle': 'helpImprove',
        'add-route-text': 'addRoute',
        'credits-title': 'creditsAndBilling',
        'credits-subtitle': 'manageUsage',
        'balance-title': 'currentBalance',
        'credits-text': 'credits',
        'usage-info': 'eachSearch',
        'purchase-title': 'purchaseCredits',
        'footer-text': 'footerText',
        'modal-title': 'addNewRoute',
        'route-name-label': 'routeName',
        'from-modal-label': 'from',
        'to-modal-label': 'to',
        'cancel-text': 'cancel',
        'submit-text': 'submitRoute',
        'create-account': 'createAccount',
        'sign-in': 'signIn',
        'logout-text': 'logout',
        'full-name': 'fullName',
        'email-label': 'email',
        'password-label': 'password',
        'preferred-currency': 'preferredCurrency',
        'create-account-with-credits': 'createAccountWithCredits',
        'welcome-back': 'welcomeBack',
        'join-community': 'joinCommunity',
        'login-required': 'loginRequired',
        'login-required-desc': 'loginRequiredDesc',
        'welcome-to-wasla': 'welcomeToWasla',
        'which-country': 'whichCountry',
        'egypt-text': 'egypt',
        'other-countries': 'otherCountries'
    };
    
    return keyMap[className];
}